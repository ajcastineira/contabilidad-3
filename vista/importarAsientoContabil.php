<?phpsession_start();require_once '../CN/clsCNContabilidad.php';$clsCNContabilidad=new clsCNContabilidad();$clsCNContabilidad->setStrBD($_SESSION['mapeo']);require_once '../CN/clsCNUsu.php';//require_once '../general/funcionesGenerales.php';$clsCNUsu=new clsCNUsu();$clsCNUsu->setStrBD($_SESSION['dbContabilidad']);$clsCNUsu->setStrBDCliente($_SESSION['mapeo']);//carga la conexion MySQLrequire_once '../general/'.$_SESSION['mapeo'];require_once '../general/myLogger.php';$db = new Db();//carga conexion Access Contabil.Mdbrequire_once '../MovimientosImpExp/msaccess.class.php';$dbAccess = new msaccess();$name=$_GET['name'];$dbAccess->setMDB($name);//cojemos los parametros$idAsiento=  $_GET["idAsiento"];$color=  $_GET["backgroundcolor"];echo '<tr style="background:'.$color.'" align="center">';echo '<td>Asiento '.$idAsiento.': ';//primero importo los datos del asiento de Contabil$strSQL="SELECT Asiento,Orden,Fecha,Periodo,CargoAbono,CodigoCuenta,Comentario,Importe FROM movimientos WHERE Asiento=$idAsiento";if(!$dbAccess->conectar()){    echo '... ERROR';    die;}$rs = $dbAccess->consulta( $strSQL );if(!$rs){    echo '... ERROR';    die;}//introduzco los datos de la consulta en un array$Asiento='';while(odbc_fetch_row($rs)){    $Asiento[]=array(        'Asiento'=>odbc_result($rs,'Asiento'),        'Orden'=>odbc_result($rs,'Orden'),        'Fecha'=>odbc_result($rs,'Fecha'),        'Periodo'=>odbc_result($rs,'Periodo'),        'CargoAbono'=>odbc_result($rs,'CargoAbono'),        'CodigoCuenta'=>odbc_result($rs,'CodigoCuenta'),        'Comentario'=>utf8_encode(odbc_result($rs,'Comentario')),        'Importe'=>odbc_result($rs,'Importe'),    );}//ahora listo los asientos a importar y preparo un array con los datos$listadoAsientos='';foreach($Asiento as $mov){    //reviso si esta cuenta existe (la busco en la tabla 'tbcuenta')    $ExisteCuenta=$clsCNContabilidad->ExisteCuenta($mov['CodigoCuenta']);        //sino existe la cuenta, la doy de alta    if(!$ExisteCuenta){        $num=$clsCNUsu->IdCliProv();        $numEmpresa=$_SESSION["idEmp"];                //si es 4300 (cliente), 4000 (proveedor) o 4100 (acreedor) la doy de alta con la funcion "AltaCuentaContactos"         //(que lo da de alta en la tabla 'tbcuenta' y 'tbcontactos')        //en el resto de cuentas se da solo de alta en la tabla 'tbcuenta' con la función "AltaCuenta"        if(substr($mov['CodigoCuenta'],0,4)==='4300' || substr($mov['CodigoCuenta'],0,4)==='4000' || substr($mov['CodigoCuenta'],0,4)==='4100'){            $varRes=$clsCNUsu->AltaCuentaContactos($mov['CodigoCuenta'],'Alta proceso importación');        }else            //resto de cuentas        {            $varRes=$clsCNUsu->AltaCuenta($mov['CodigoCuenta'],substr($mov['CodigoCuenta'],0,1),substr($mov['CodigoCuenta'],0,2),substr($mov['CodigoCuenta'],0,4),'Alta proceso importación');        }    }            //voy introduciendo en el array $listadoAsientos los datos de este asiento    $mes=date('m',strtotime($mov['Fecha']));    while(substr($mes,0,1)==='0'){        $mes=substr($mes,1);    }                $listadoAsientos[$mov['Asiento']]['Asiento']=$mov['Asiento'];    $listadoAsientos[$mov['Asiento']]['FechaApunte']=$mov['Fecha'];    $listadoAsientos[$mov['Asiento']]['Periodo']=$mes;    $listadoAsientos[$mov['Asiento']]['concepto'.$mov['CargoAbono'].$mov['CodigoCuenta']]=$mov['Comentario'];    $listadoAsientos[$mov['Asiento']][$mov['CargoAbono'].$mov['CodigoCuenta']]=(float)$mov['Importe'];}//ahora con este listado, lo que hacemos es recorrerlo para ir insertando cada asientoforeach($listadoAsientos as $asiento){        //ESTO ERA ANTES    //primero compruebo si existe este asiento en nuestra BBDD    //si existe Asiento, lo que hago es darlo de baja//    if($clsCNContabilidad->existeAsiento($asiento['Asiento'])==='SI'){//        $OK=$clsCNContabilidad->DarBajaAsiento($asiento['Asiento']);//    }    //AHORA    //buscamos numero nuevo de asiento    $numAsientoNuevo=$clsCNContabilidad->NuevoAsiento();        //extraigo un listado de la tabla 'movimientosIva', si no existe la tabla dev false    $listadotablaMovimientosIva=$clsCNContabilidad->importarMovimientosIvaContabil($name,$asiento['Asiento']);    //recorro el listado y lo introsuzco en un array de ivas    $ivas=array(        '0'=>'NO',        'Base0'=>0.00,        '4'=>'NO',        'Base4'=>0.00,        'Cuota4'=>0.00,        '10'=>'NO',        'Base10'=>0.00,        'Cuota10'=>0.00,        '21'=>'NO',        'Base21'=>0.00,        'Cuota21'=>0.00,    );    if(is_array($listadotablaMovimientosIva)){        foreach($listadotablaMovimientosIva as $movIva){            if($movIva['CodigoIva']===0){                $ivas['0']='SI';                $ivas['Base0']=$ivas['Base0']+(float)$movIva['BaseIva'];            }else            if($movIva['CodigoIva']===4){                $ivas['4']='SI';                $ivas['Base4']=$ivas['Base4']+(float)$movIva['BaseIva'];                $ivas['Cuota4']=$ivas['Cuota4']+(float)$movIva['CuotaIva'];            }else            if($movIva['CodigoIva']===10){                $ivas['10']='SI';                $ivas['Base10']=$ivas['Base10']+(float)$movIva['BaseIva'];                $ivas['Cuota10']=$ivas['Cuota10']+(float)$movIva['CuotaIva'];            }else            if($movIva['CodigoIva']===21){                $ivas['21']='SI';                $ivas['Base21']=$ivas['Base21']+(float)$movIva['BaseIva'];                $ivas['Cuota21']=$ivas['Cuota21']+(float)$movIva['CuotaIva'];            }        }    }    //compruebo los ivas (cuento os NOes o SIes que hay en el array $ivas    $contIVA=0;    foreach($ivas as $prop=>$valor){        if($valor==='SI'){            $contIVA++;        }    }    //voy a recorrer todo el asiento, controlo si existen las cuentas antes definidas arriba    //(7, 6, 43, 40 o 41, 4770, 4720, 4730, 4751, 57) y OTRAS (array)    $cuentasAsiento=array(        '7D'=>0,        '7H'=>0,        '6D'=>0,        '6H'=>0,        '43D'=>0,        '43H'=>0,        '40-41D'=>0,        '40-41H'=>0,        '4770D'=>0,        '4770H'=>0,        '4720D'=>0,        '4720H'=>0,        '4730D'=>0,        '4730H'=>0,        '4751D'=>0,        '4751H'=>0,        '57D'=>0,        '57H'=>0,        'OCUENTAS'=>0,        'OTRAS'=>'',    );    //ahora con las cuentas y los ivas sabremos el tipo de asiento que es    $concepto='';    foreach($asiento as $prop=>$valor){        //comprobobar si es asiento normal o abono (7-H, 4770-H, 43-D)        if(substr($prop,1,1)==='7'){            $cuenta7=substr($prop,1,9);            $cantidad7=(float)$valor;            if(substr($prop,0,1)==='H'){                $cuentasAsiento['7H']=$cuentasAsiento['7H']+1;            }else{                $cuentasAsiento['7D']=$cuentasAsiento['7D']+1;            }        }        if(substr($prop,1,4)==='4770'){            $cantidad4770=(float)$valor;            if(substr($prop,0,1)==='H'){                $cuentasAsiento['4770H']=$cuentasAsiento['4770H']+1;            }else{                $cuentasAsiento['4770D']=$cuentasAsiento['4770D']+1;            }        }        if(substr($prop,1,2)==='43'){            $cuenta43=substr($prop,1,9);            $cantidad43=(float)$valor;            if(substr($prop,0,1)==='D'){                $cuentasAsiento['43D']=$cuentasAsiento['43D']+1;            }else{                $cuentasAsiento['43H']=$cuentasAsiento['43H']+1;            }        }        //comprobobar si es asiento normal o abono (6-D, 4720-D, 40-H)        if(substr($prop,1,1)==='6'){            $cuenta6=substr($prop,1,9);            $cantidad6=(float)$valor;            if(substr($prop,0,1)==='D'){                $cuentasAsiento['6D']=$cuentasAsiento['6D']+1;            }else{                $cuentasAsiento['6H']=$cuentasAsiento['6H']+1;            }        }        if(substr($prop,1,4)==='4720'){            $cantidad4720=(float)$valor;            if(substr($prop,0,1)==='D'){                $cuentasAsiento['4720D']=$cuentasAsiento['4720D']+1;            }else{                $cuentasAsiento['4720H']=$cuentasAsiento['4720H']+1;            }        }        if(substr($prop,1,2)==='40' || substr($prop,1,2)==='41'){            $cuenta40=substr($prop,1,9);            $cantidad40=(float)$valor;            if(substr($prop,0,1)==='H'){                $cuentasAsiento['40-41H']=$cuentasAsiento['40-41H']+1;            }else{                $cuentasAsiento['40-41D']=$cuentasAsiento['40-41D']+1;            }        }        if(substr($prop,1,4)==='4730'){            $cantidad4730=(float)$valor;            if(substr($prop,0,1)==='D'){                $cuentasAsiento['4730D']=$cuentasAsiento['4730D']+1;            }else{                $cuentasAsiento['4730H']=$cuentasAsiento['4730H']+1;            }        }        if(substr($prop,1,4)==='4751'){            $cantidad4751=(float)$valor;            if(substr($prop,0,1)==='D'){                $cuentasAsiento['4751D']=$cuentasAsiento['4751D']+1;            }else{                $cuentasAsiento['4751H']=$cuentasAsiento['4751H']+1;            }        }        //busco si hay banco o caja (cuenta 57)        $optTipo=0;        if(substr($prop,1,2)==='57'){            $optTipo=1;            $cuenta57=substr($prop,1,9);            if(substr($prop,0,1)==='H'){                $cuentasAsiento['57H']=$cuentasAsiento['57H']+1;            }else{                $cuentasAsiento['57D']=$cuentasAsiento['57D']+1;            }        }        //busco si hay otras cuentas (posiciones 1 a 9 son numericas)        if(is_numeric(substr($prop,1,9))){            $cuentasAsiento['OTRAS'][]=array("IdMovimiento"=>0,                                        "Cuenta"=>substr($prop,1,9),                                        "Concepto"=>addslashes($asiento['concepto'.$prop]),                                        "Cantidad"=>$valor,                                        "DoH"=>substr($prop,0,1)            );        }        if(substr($prop,0,8)==='concepto'){            $concepto=addslashes($valor);        }    }    //ivas (si solo es uno)    $porciento=0;    $iva=0;    if($ivas['0']==='SI'){        $porciento=0;        $iva=0;    }else    if($ivas['4']==='SI'){        $porciento=4;        $iva=$ivas['Cuota4'];    }else    if($ivas['10']==='SI'){        $porciento=10;        $iva=$ivas['Cuota10'];    }else    if($ivas['21']==='SI'){        $porciento=21;        $iva=$ivas['Cuota21'];    }    //calculo %IRPF de las cuentas 4730(INGRESO) y 4751(GASTO)    //compruebo que existen    if(isset($cantidad7)){        if(isset($cantidad4730)){            $PorcientoIRPF=(int)round($cantidad4730/$cantidad7*100,0);        }    }else{        $PorcientoIRPF=0;    }        if(isset($cantidad6)){        if(isset($cantidad4751)){            $PorcientoIRPF=(int)round($cantidad4751/$cantidad6*100,0);        }    }else{        $PorcientoIRPF=0;    }    //tipos 0 o 1    $c6D=$cuentasAsiento['6D'];    $c6H=$cuentasAsiento['6H'];    $c7D=$cuentasAsiento['7D'];    $c7H=$cuentasAsiento['7H'];    $c40_41D=$cuentasAsiento['40-41D'];    $c40_41H=$cuentasAsiento['40-41H'];    $c43D=$cuentasAsiento['43D'];    $c43H=$cuentasAsiento['43H'];    $c4720D=$cuentasAsiento['4720D'];    $c4720H=$cuentasAsiento['4720H'];    $c4770D=$cuentasAsiento['4770D'];    $c4770H=$cuentasAsiento['4770H'];    $c4730D=$cuentasAsiento['4730D'];    $c4730H=$cuentasAsiento['4730H'];    $c4751D=$cuentasAsiento['4751D'];    $c4751H=$cuentasAsiento['4751H'];    $c57D=$cuentasAsiento['57D'];    $c57H=$cuentasAsiento['57H'];    //aqui averiguamos de que tipo son segun esta estructura    //en la vbel $cuentasAsientos vienen estas variables con cantidades (6,7,40,43,4720,4770,4730,4751 y 57)    //    //    //00N                              00A    //----------------------------------------------------------    //$cuentasAsiento[6D]=1            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=1    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=0    //$cuentasAsiento[7H]=0            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=1    //$cuentasAsiento[40H]=1           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=0           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=0    //$cuentasAsiento[4720D]=0         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=0    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=0    //$cuentasAsiento[4770H]=0         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=0    //    if($c6D===1 && $c7D===0 && $c40_41D===0 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0){        $tipo='00N';    }else    if($c6D===0 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===1 && $c7H===0 && $c40_41H===0 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0){        $tipo='00A';    }else    //00N (banco)                      00A (banco)    //----------------------------------------------------------    //$cuentasAsiento[6D]=1            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=1    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=0    //$cuentasAsiento[7H]=0            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=1           $cuentasAsiento[40D]=1    //$cuentasAsiento[40H]=1           $cuentasAsiento[40H]=1    //$cuentasAsiento[43D]=0           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=0    //$cuentasAsiento[4720D]=0         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=0    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=0    //$cuentasAsiento[4770H]=0         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=1    //$cuentasAsiento[57H]=1           $cuentasAsiento[57H]=0    //    if($c6D===1 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===1){        $tipo='00N';    }else    if($c6D===0 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===1       && $c6H===1 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0){        $tipo='00A';    }else    //01N                              01A    //----------------------------------------------------------    //$cuentasAsiento[6D]=1            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=1    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=0    //$cuentasAsiento[7H]=0            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=1    //$cuentasAsiento[40H]=1           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=0           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=0    //$cuentasAsiento[4720D]=1         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=1    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=0    //$cuentasAsiento[4770H]=0         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=0    //    // y $contIVA===1    if($c6D===1 && $c7D===0 && $c40_41D===0 && $c43D===0 && $c4720D===1 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA===1){        $tipo='01N';    }else    if($c6D===0 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===1 && $c7H===0 && $c40_41H===0 && $c43H===0 && $c4720H===1 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA===1){        $tipo='01A';    }else    //01N (Banco)                      01A (Banco)    //----------------------------------------------------------    //$cuentasAsiento[6D]=1            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=1    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=0    //$cuentasAsiento[7H]=0            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=1           $cuentasAsiento[40D]=1    //$cuentasAsiento[40H]=1           $cuentasAsiento[40H]=1    //$cuentasAsiento[43D]=0           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=0    //$cuentasAsiento[4720D]=1         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=1    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=0    //$cuentasAsiento[4770H]=0         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=1    //$cuentasAsiento[57H]=1           $cuentasAsiento[57H]=0    //    // y $contIVA===1    if($c6D===1 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===1 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===1 && $contIVA===1){        $tipo='01N';    }else    if($c6D===0 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===1       && $c6H===1 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===1 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA===1){        $tipo='01A';    }else    //02N                              02A    //----------------------------------------------------------    //$cuentasAsiento[6D]=1            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=1    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=0    //$cuentasAsiento[7H]=0            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=1    //$cuentasAsiento[40H]=1           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=0           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=0    //$cuentasAsiento[4720D]=1         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=1    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=0    //$cuentasAsiento[4770H]=0         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=1    //$cuentasAsiento[4751H]=1         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=0    //    // y $contIVA===1    if($c6D===1 && $c7D===0 && $c40_41D===0 && $c43D===0 && $c4720D===1 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===1 && $c57H===0 && $contIVA===1){        $tipo='02N';    }else    if($c6D===0 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===1 && $c57D===0       && $c6H===1 && $c7H===0 && $c40_41H===0 && $c43H===0 && $c4720H===1 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA===1){        $tipo='02A';    }else    //02N (Banco)                      02A (Banco)    //----------------------------------------------------------    //$cuentasAsiento[6D]=1            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=1    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=0    //$cuentasAsiento[7H]=0            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=1           $cuentasAsiento[40D]=1    //$cuentasAsiento[40H]=1           $cuentasAsiento[40H]=1    //$cuentasAsiento[43D]=0           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=0    //$cuentasAsiento[4720D]=1         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=1    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=0    //$cuentasAsiento[4770H]=0         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=1    //$cuentasAsiento[4751H]=1         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=1    //$cuentasAsiento[57H]=1           $cuentasAsiento[57H]=0    //    // y $contIVA===1    if($c6D===1 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===1 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===1 && $c57H===1 && $contIVA===1){        $tipo='02N';    }else    if($c6D===0 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===1 && $c57D===1       && $c6H===1 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===1 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA===1){        $tipo='02A';    }else    //03N                              03A     //----------------------------------------------------------    //$cuentasAsiento[6D]=1            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=1    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=0    //$cuentasAsiento[7H]=0            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=1    //$cuentasAsiento[40H]=1           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=0           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=0    //$cuentasAsiento[4720D]=1         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=1    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=0    //$cuentasAsiento[4770H]=0         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=0    //    // y $contIVA>1    if($c6D===1 && $c7D===0 && $c40_41D===0 && $c43D===0 && $c4720D===1 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA>1){        $tipo='03N';    }else    if($c6D===0 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===1 && $c7H===0 && $c40_41H===0 && $c43H===0 && $c4720H===1 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA>1){        $tipo='03A';    }else    //03N (Banco)                      03A (Banco)    //----------------------------------------------------------    //$cuentasAsiento[6D]=1            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=1    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=0    //$cuentasAsiento[7H]=0            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=1           $cuentasAsiento[40D]=1    //$cuentasAsiento[40H]=1           $cuentasAsiento[40H]=1    //$cuentasAsiento[43D]=0           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=0    //$cuentasAsiento[4720D]=1         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=1    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=0    //$cuentasAsiento[4770H]=0         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=1    //$cuentasAsiento[57H]=1           $cuentasAsiento[57H]=0    //    // y $contIVA>1    if($c6D===1 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===1 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===1 && $contIVA>1){        $tipo='03N';    }else    if($c6D===0 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===1       && $c6H===1 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===1 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA>1){        $tipo='03A';    }else    //04N                              04A    //----------------------------------------------------------    //$cuentasAsiento[6D]=1            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=1    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=0    //$cuentasAsiento[7H]=0            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=1    //$cuentasAsiento[40H]=1           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=0           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=0    //$cuentasAsiento[4720D]=1         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=1    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=0    //$cuentasAsiento[4770H]=0         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=1    //$cuentasAsiento[4751H]=1         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=0    //    // y $contIVA>1    if($c6D===1 && $c7D===0 && $c40_41D===0 && $c43D===0 && $c4720D===1 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===1 && $c57H===0 && $contIVA>1){        $tipo='04N';    }else    if($c6D===0 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===1 && $c57D===0       && $c6H===1 && $c7H===0 && $c40_41H===0 && $c43H===0 && $c4720H===1 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA>1){        $tipo='04A';    }else    //04N (Banco)                      04A (Banco)    //----------------------------------------------------------    //$cuentasAsiento[6D]=1            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=1    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=0    //$cuentasAsiento[7H]=0            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=1           $cuentasAsiento[40D]=1    //$cuentasAsiento[40H]=1           $cuentasAsiento[40H]=1    //$cuentasAsiento[43D]=0           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=0    //$cuentasAsiento[4720D]=1         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=1    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=0    //$cuentasAsiento[4770H]=0         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=1    //$cuentasAsiento[4751H]=1         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=1    //$cuentasAsiento[57H]=1           $cuentasAsiento[57H]=0    //    // y $contIVA>1    if($c6D===1 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===1 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===1 && $c57H===1 && $contIVA>1){        $tipo='04N';    }else    if($c6D===0 && $c7D===0 && $c40_41D===1 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===1 && $c57D===1       && $c6H===1 && $c7H===0 && $c40_41H===1 && $c43H===0 && $c4720H===1 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA>1){        $tipo='04A';    }else    //10N                              10A    //----------------------------------------------------------    //$cuentasAsiento[6D]=0            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=0    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=1    //$cuentasAsiento[7H]=1            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=0    //$cuentasAsiento[40H]=0           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=1           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=1    //$cuentasAsiento[4720D]=0         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=0    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=0    //$cuentasAsiento[4770H]=0         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=0    //    if($c6D===0 && $c7D===0 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===1 && $c40_41H===0 && $c43H===0 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0){        $tipo='10N';    }else    if($c6D===0 && $c7D===1 && $c40_41D===0 && $c43D===0 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0){        $tipo='10A';    }else    //10N (banco)                      10A (banco)    //----------------------------------------------------------    //$cuentasAsiento[6D]=0            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=0    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=1    //$cuentasAsiento[7H]=1            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=0    //$cuentasAsiento[40H]=0           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=1           $cuentasAsiento[43D]=1    //$cuentasAsiento[43H]=1           $cuentasAsiento[43H]=1    //$cuentasAsiento[4720D]=0         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=0    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=0    //$cuentasAsiento[4770H]=0         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=1           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=1    //    if($c6D===0 && $c7D===0 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===1       && $c6H===0 && $c7H===1 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0){        $tipo='10N';    }else    if($c6D===0 && $c7D===1 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===1){        $tipo='10A';    }else    //11N                              11A    //----------------------------------------------------------    //$cuentasAsiento[6D]=0            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=0    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=1    //$cuentasAsiento[7H]=1            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=0    //$cuentasAsiento[40H]=0           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=1           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=1    //$cuentasAsiento[4720D]=0         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=0    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=1    //$cuentasAsiento[4770H]=1         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=0    //    // y $contIVA===1    if($c6D===0 && $c7D===0 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===1 && $c40_41H===0 && $c43H===0 && $c4720H===0 && $c4770H===1 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA===1){        $tipo='11N';    }else    if($c6D===0 && $c7D===1 && $c40_41D===0 && $c43D===0 && $c4720D===0 && $c4770D===1 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA===1){        $tipo='11A';    }else    //11N (Banco)                      11A (Banco)    //----------------------------------------------------------    //$cuentasAsiento[6D]=0            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=0    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=1    //$cuentasAsiento[7H]=1            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=0    //$cuentasAsiento[40H]=0           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=1           $cuentasAsiento[43D]=1    //$cuentasAsiento[43H]=1           $cuentasAsiento[43H]=1    //$cuentasAsiento[4720D]=0         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=0    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=1    //$cuentasAsiento[4770H]=1         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=1           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=1    //    // y $contIVA===1    if($c6D===0 && $c7D===0 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===1       && $c6H===0 && $c7H===1 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===1 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA===1){        $tipo='11N';    }else    if($c6D===0 && $c7D===1 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===1 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===1 && $contIVA===1){        $tipo='11A';    }else    //12N                              12A    //----------------------------------------------------------    //$cuentasAsiento[6D]=0            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=0    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=1    //$cuentasAsiento[7H]=1            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=0    //$cuentasAsiento[40H]=0           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=1           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=1    //$cuentasAsiento[4720D]=0         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=0    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=1    //$cuentasAsiento[4770H]=1         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=1         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=1    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=0    //    // y $contIVA===1    if($c6D===0 && $c7D===0 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===0 && $c4730D===1 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===1 && $c40_41H===0 && $c43H===0 && $c4720H===0 && $c4770H===1 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA===1){        $tipo='12N';    }else    if($c6D===0 && $c7D===1 && $c40_41D===0 && $c43D===0 && $c4720D===0 && $c4770D===1 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===0 && $c4730H===1 && $c4751H===0 && $c57H===0 && $contIVA===1){        $tipo='12A';    }else    //12N (Banco)                      12A (Banco)    //----------------------------------------------------------    //$cuentasAsiento[6D]=0            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=0    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=1    //$cuentasAsiento[7H]=1            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=0    //$cuentasAsiento[40H]=0           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=1           $cuentasAsiento[43D]=1    //$cuentasAsiento[43H]=1           $cuentasAsiento[43H]=1    //$cuentasAsiento[4720D]=0         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=0    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=1    //$cuentasAsiento[4770H]=1         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=1         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=1    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=1           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=1    //    // y $contIVA===1    if($c6D===0 && $c7D===0 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===0 && $c4730D===1 && $c4751D===0 && $c57D===1       && $c6H===0 && $c7H===1 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===1 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA===1){        $tipo='12N';    }else    if($c6D===0 && $c7D===1 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===1 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===0 && $c4730H===1 && $c4751H===0 && $c57H===1 && $contIVA===1){        $tipo='12A';    }else    //13N                              13A    //----------------------------------------------------------    //$cuentasAsiento[6D]=0            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=0    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=1    //$cuentasAsiento[7H]=1            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=0    //$cuentasAsiento[40H]=0           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=1           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=1    //$cuentasAsiento[4720D]=0         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=0    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=1    //$cuentasAsiento[4770H]=1         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=0    //    // y $contIVA>1    if($c6D===0 && $c7D===0 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===1 && $c40_41H===0 && $c43H===0 && $c4720H===0 && $c4770H===1 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA>1){        $tipo='13N';    }else    if($c6D===0 && $c7D===1 && $c40_41D===0 && $c43D===0 && $c4720D===0 && $c4770D===1 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA>1){        $tipo='13A';    }else    //13N (Banco)                      13A (Banco)    //----------------------------------------------------------    //$cuentasAsiento[6D]=0            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=0    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=1    //$cuentasAsiento[7H]=1            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=0    //$cuentasAsiento[40H]=0           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=1           $cuentasAsiento[43D]=1    //$cuentasAsiento[43H]=1           $cuentasAsiento[43H]=1    //$cuentasAsiento[4720D]=0         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=0    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=1    //$cuentasAsiento[4770H]=1         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=0         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=0    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=1           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=1    //    // y $contIVA>1    if($c6D===0 && $c7D===0 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===0 && $c4730D===0 && $c4751D===0 && $c57D===1       && $c6H===0 && $c7H===1 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===1 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA>1){        $tipo='13N';    }else    if($c6D===0 && $c7D===1 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===1 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===0 && $c4730H===0 && $c4751H===0 && $c57H===1 && $contIVA>1){        $tipo='13A';    }else    //14N                              14A    //----------------------------------------------------------    //$cuentasAsiento[6D]=0            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=0    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=1    //$cuentasAsiento[7H]=1            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=0    //$cuentasAsiento[40H]=0           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=1           $cuentasAsiento[43D]=0    //$cuentasAsiento[43H]=0           $cuentasAsiento[43H]=1    //$cuentasAsiento[4720D]=0         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=0    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=1    //$cuentasAsiento[4770H]=1         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=1         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=1    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=0           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=0    //    // y $contIVA>1    if($c6D===0 && $c7D===0 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===0 && $c4730D===1 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===1 && $c40_41H===0 && $c43H===0 && $c4720H===0 && $c4770H===1 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA>1){        $tipo='14N';    }else    if($c6D===0 && $c7D===1 && $c40_41D===0 && $c43D===0 && $c4720D===0 && $c4770D===1 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===0 && $c4730H===1 && $c4751H===0 && $c57H===0 && $contIVA>1){        $tipo='14A';    }else    //14N (Banco)                      14A (Banco)    //----------------------------------------------------------    //$cuentasAsiento[6D]=0            $cuentasAsiento[6D]=0    //$cuentasAsiento[6H]=0            $cuentasAsiento[6H]=0    //$cuentasAsiento[7D]=0            $cuentasAsiento[7D]=1    //$cuentasAsiento[7H]=1            $cuentasAsiento[7H]=0    //$cuentasAsiento[40D]=0           $cuentasAsiento[40D]=0    //$cuentasAsiento[40H]=0           $cuentasAsiento[40H]=0    //$cuentasAsiento[43D]=1           $cuentasAsiento[43D]=1    //$cuentasAsiento[43H]=1           $cuentasAsiento[43H]=1    //$cuentasAsiento[4720D]=0         $cuentasAsiento[4720D]=0    //$cuentasAsiento[4720H]=0         $cuentasAsiento[4720H]=0    //$cuentasAsiento[4770D]=0         $cuentasAsiento[4770D]=1    //$cuentasAsiento[4770H]=1         $cuentasAsiento[4770H]=0    //$cuentasAsiento[4730D]=1         $cuentasAsiento[4730D]=0    //$cuentasAsiento[4730H]=0         $cuentasAsiento[4730H]=1    //$cuentasAsiento[4751D]=0         $cuentasAsiento[4751D]=0    //$cuentasAsiento[4751H]=0         $cuentasAsiento[4751H]=0    //$cuentasAsiento[57D]=1           $cuentasAsiento[57D]=0    //$cuentasAsiento[57H]=0           $cuentasAsiento[57H]=1    //    // y $contIVA>1    if($c6D===0 && $c7D===0 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===0 && $c4730D===1 && $c4751D===0 && $c57D===1       && $c6H===0 && $c7H===1 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===1 && $c4730H===0 && $c4751H===0 && $c57H===0 && $contIVA>1){        $tipo='14N';    }else    if($c6D===0 && $c7D===1 && $c40_41D===0 && $c43D===1 && $c4720D===0 && $c4770D===1 && $c4730D===0 && $c4751D===0 && $c57D===0       && $c6H===0 && $c7H===0 && $c40_41H===0 && $c43H===1 && $c4720H===0 && $c4770H===0 && $c4730H===1 && $c4751H===0 && $c57H===1 && $contIVA>1){        $tipo='14A';    }else{        //sino es ninguna de las anteriores de 0 o 1 será tipo2 (por defecto)        $tipo='Tipo2';    }//            }    //fecha 6/5/2014    $fechas =explode('-',$asiento['FechaApunte']);    $fecha=substr($fechas[2],0,2).'/'.$fechas[1].'/'.$fechas[0];    $ejercicio =$fechas[0];    //preparamos los datos para la insercion    //ahora segun sea $tipo sabemos el tipo de asiento    switch ($tipo) {        case '10N':            $OK2=$clsCNContabilidad->AltaIngresosMovimientosSinIVA($numAsientoNuevo, $_SESSION['idEmp'], $cuenta7, $cantidad7, $cuenta43,                                                      $cantidad43, $fecha, $optTipo, $cuenta57, $asiento['Periodo'],                                                      $ejercicio, $concepto, 'NO', $_SESSION['strUsuario']);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '10A':            $OK2=$clsCNContabilidad->AltaIngresosMovimientosSinIVA($numAsientoNuevo, $_SESSION['idEmp'], $cuenta7, $cantidad7, $cuenta43,                                                      $cantidad43, $fecha, $optTipo, $cuenta57, $asiento['Periodo'],                                                      $ejercicio, $concepto, 'SI', $_SESSION['strUsuario']);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '11N':            $OK2=$clsCNContabilidad->AltaIngresosMovimientos($numAsientoNuevo, $_SESSION['idEmp'], $cuenta7, $cantidad43, $cuenta43, $cantidad7,                                                $iva, $porciento, $fecha, $optTipo, $cuenta57, $asiento['Periodo'],                                                $ejercicio, $concepto, 'NO', $_SESSION['strUsuario']);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '11A':            $OK2=$clsCNContabilidad->AltaIngresosMovimientos($numAsientoNuevo, $_SESSION['idEmp'], $cuenta7, $cantidad43, $cuenta43, $cantidad7,                                                abs($iva), $porciento, $fecha, $optTipo, $cuenta57, $asiento['Periodo'],                                                $ejercicio, $concepto, 'SI', $_SESSION['strUsuario']);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '13N':            $OK2=$clsCNContabilidad->AltaIngresosMovimientosIVA_Varios($numAsientoNuevo, $_SESSION['idEmp'], $cuenta7, $cantidad43, $cuenta43, $cantidad7,                                                          $cantidad4770, $fecha, $optTipo, $cuenta57, $asiento['Periodo'], $ejercicio,                                                          $concepto, $_SESSION['strUsuario'],                                                          $ivas['Base0'], 0, 0,                                                          $ivas['Base4'], $ivas['Cuota4'], 4,                                                          $ivas['Base10'], $ivas['Cuota10'], 10,                                                          $ivas['Base21'], $ivas['Cuota21'], 21, 'NO');            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '13A':            $OK2=$clsCNContabilidad->AltaIngresosMovimientosIVA_Varios($numAsientoNuevo, $_SESSION['idEmp'], $cuenta7, $cantidad43, $cuenta43, $cantidad7,                                                          $cantidad4770, $fecha, $optTipo, $cuenta57, $asiento['Periodo'], $ejercicio,                                                          $concepto, $_SESSION['strUsuario'],                                                          abs($ivas['Base0']), 0, 0,                                                          abs($ivas['Base4']), abs($ivas['Cuota4']), 4,                                                          abs($ivas['Base10']), abs($ivas['Cuota10']), 10,                                                          abs($ivas['Base21']), abs($ivas['Cuota21']), 21, 'SI');            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '12N':            $OK2=$clsCNContabilidad->AltaIngresosMovimientosIRPF($numAsientoNuevo, $_SESSION['idEmp'], $cuenta7, $cuenta43, $cantidad7, $cantidad4770,                                                    $porciento, $cantidad4730, $PorcientoIRPF, $fecha, $optTipo, $cuenta57, $asiento['Periodo'],                                                     $clsCNContabilidad->periodo($asiento['Periodo']), $ejercicio,  $concepto, 'NO', $_SESSION['strUsuario']);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '12A':            $OK2=$clsCNContabilidad->AltaIngresosMovimientosIRPF($numAsientoNuevo, $_SESSION['idEmp'], $cuenta7, $cuenta43, $cantidad7, $cantidad4770,                                                    $porciento, $cantidad4730, $PorcientoIRPF, $fecha, $optTipo, $cuenta57, $asiento['Periodo'],                                                     $clsCNContabilidad->periodo($asiento['Periodo']), $ejercicio,  $concepto, 'SI', $_SESSION['strUsuario']);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '14N':            $OK2=$clsCNContabilidad->AltaIngresosMovimientosIVA_VariosIRPF($numAsientoNuevo, $_SESSION['idEmp'], $cuenta7, $cantidad43, $cuenta43, $cantidad7,                                                              $cantidad4770, $fecha, $optTipo, $cuenta57, $asiento['Periodo'],                                                              $ejercicio, $concepto, $_SESSION['strUsuario'],                                                              $ivas['Base0'], 0, 0,                                                              $ivas['Base4'], $ivas['Cuota4'], 4,                                                              $ivas['Base10'], $ivas['Cuota10'], 10,                                                              $ivas['Base21'], $ivas['Cuota21'], 21,                                                              'NO', $PorcientoIRPF, $cantidad4730);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '14A':            $OK2=$clsCNContabilidad->AltaIngresosMovimientosIVA_VariosIRPF($numAsientoNuevo, $_SESSION['idEmp'], $cuenta7, $cantidad43, $cuenta43, $cantidad7,                                                              $cantidad4770, $fecha, $optTipo, $cuenta57, $asiento['Periodo'],                                                              $ejercicio, $concepto, $_SESSION['strUsuario'],                                                              abs($ivas['Base0']), 0, 0,                                                              abs($ivas['Base4']), abs($ivas['Cuota4']), 4,                                                              abs($ivas['Base10']), abs($ivas['Cuota10']), 10,                                                              abs($ivas['Base21']), abs($ivas['Cuota21']), 21,                                                              'SI', $PorcientoIRPF, $cantidad4730);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '00N':            $OK2=$clsCNContabilidad->AltaGastosMovimientosSinIVA($numAsientoNuevo, $_SESSION['idEmp'], $cuenta6, $cantidad6, $cuenta40, $cantidad40,                                                    $fecha, $optTipo, $cuenta57, $asiento['Periodo'], $ejercicio,                                                    $concepto, 'NO', $_SESSION['strUsuario']);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '00A':            $OK2=$clsCNContabilidad->AltaGastosMovimientosSinIVA($numAsientoNuevo, $_SESSION['idEmp'], $cuenta6, $cantidad6, $cuenta40, $cantidad40,                                                    $fecha, $optTipo, $cuenta57, $asiento['Periodo'], $ejercicio,                                                    $concepto, 'SI', $_SESSION['strUsuario']);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '01N':            $OK2=$clsCNContabilidad->AltaGastosMovimientos($numAsientoNuevo, $_SESSION['idEmp'], $cuenta6, $cantidad40, $cuenta40, $cantidad6, $cantidad4720,                                              $porciento, $fecha, $optTipo, $cuenta57, $asiento['Periodo'], $ejercicio,                                              $concepto, 'NO', $_SESSION['strUsuario']);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '01A':            $OK2=$clsCNContabilidad->AltaGastosMovimientos($numAsientoNuevo, $_SESSION['idEmp'], $cuenta6, $cantidad40, $cuenta40, $cantidad6, $cantidad4720,                                              $porciento, $fecha, $optTipo, $cuenta57, $asiento['Periodo'], $ejercicio,                                              $concepto, 'SI', $_SESSION['strUsuario']);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '03N':            $OK2=$clsCNContabilidad->AltaGastosMovimientosIVA_Varios($numAsientoNuevo, $_SESSION['idEmp'], $cuenta6, $cantidad40, $cuenta40, $cantidad6,                                                         $cantidad4720, $fecha, $optTipo, $cuenta57, $asiento['Periodo'], $ejercicio, $concepto, $_SESSION['strUsuario'],                                                        abs($ivas['Base0']), 0, 0,                                                        abs($ivas['Base4']), abs($ivas['Cuota4']), 4,                                                        abs($ivas['Base10']), abs($ivas['Cuota10']), 10,                                                        abs($ivas['Base21']), abs($ivas['Cuota21']), 21, 'NO');            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '03A':            $OK2=$clsCNContabilidad->AltaGastosMovimientosIVA_Varios($numAsientoNuevo, $_SESSION['idEmp'], $cuenta6, $cantidad40, $cuenta40, $cantidad6,                                                         $cantidad4720, $fecha, $optTipo, $cuenta57, $asiento['Periodo'], $ejercicio, $concepto, $_SESSION['strUsuario'],                                                        abs($ivas['Base0']), 0, 0,                                                        abs($ivas['Base4']), abs($ivas['Cuota4']), 4,                                                        abs($ivas['Base10']), abs($ivas['Cuota10']), 10,                                                        abs($ivas['Base21']), abs($ivas['Cuota21']), 21, 'SI');            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '02N':            $OK2=$clsCNContabilidad->AltaGastosMovimientosIRPF($numAsientoNuevo, $_SESSION['idEmp'], $cuenta6, $cuenta40, $cantidad6, $cantidad4720, $porciento,                                                  $cantidad4751, $PorcientoIRPF, $fecha, $optTipo, $cuenta57, $asiento['Periodo'],                                                  $clsCNContabilidad->periodo($asiento['Periodo']), $ejercicio, $concepto, 'NO', $_SESSION['strUsuario']);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '02A':            $OK2=$clsCNContabilidad->AltaGastosMovimientosIRPF($numAsientoNuevo, $_SESSION['idEmp'], $cuenta6, $cuenta40, $cantidad6, $cantidad4720, $porciento,                                                  $cantidad4751, $PorcientoIRPF, $fecha, $optTipo, $cuenta57, $asiento['Periodo'],                                                  $clsCNContabilidad->periodo($asiento['Periodo']), $ejercicio, $concepto, 'SI', $_SESSION['strUsuario']);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '04N':            $OK2=$clsCNContabilidad->AltaGastosMovimientosIVA_VariosIRPF($numAsientoNuevo, $_SESSION['idEmp'], $cuenta6, $cantidad40, $cuenta40, $cantidad6, $cantidad4720,                                                            $fecha, $optTipo, $cuenta57, $asiento['Periodo'], $ejercicio, $concepto, $_SESSION['strUsuario'],                                                             abs($ivas['Base0']), 0, 0,                                                            abs($ivas['Base4']), abs($ivas['Cuota4']), 4,                                                            abs($ivas['Base10']), abs($ivas['Cuota10']), 10,                                                            abs($ivas['Base21']), abs($ivas['Cuota21']), 21,                                                            'NO', $PorcientoIRPF, $cantidad4751);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case '04A':            $OK2=$clsCNContabilidad->AltaGastosMovimientosIVA_VariosIRPF($numAsientoNuevo, $_SESSION['idEmp'], $cuenta6, $cantidad40, $cuenta40, $cantidad6, $cantidad4720,                                                            $fecha, $optTipo, $cuenta57, $asiento['Periodo'], $ejercicio, $concepto, $_SESSION['strUsuario'],                                                             abs($ivas['Base0']), 0, 0,                                                            abs($ivas['Base4']), abs($ivas['Cuota4']), 4,                                                            abs($ivas['Base10']), abs($ivas['Cuota10']), 10,                                                            abs($ivas['Base21']), abs($ivas['Cuota21']), 21,                                                            'SI', $PorcientoIRPF, $cantidad4751);            //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;        case 'Tipo2':            //extraemos los datos de este asiento original            $datosDebeAsiento=$clsCNContabilidad->leeAsiento($numAsientoNuevo,'D');            $datosHaberAsiento=$clsCNContabilidad->leeAsiento($numAsientoNuevo,'H');            $datosAsientoOriginal='';            for($i=1;$i<=count($datosDebeAsiento);$i++){                $datosAsientoOriginal[]=array(                                            "IdMovimiento"=>$datosDebeAsiento[$i]["IdMovimiento"],                                            "asiento"=>$datosDebeAsiento[$i]["asiento"],                                            "cuenta"=>$datosDebeAsiento[$i]["cuenta"],                                            "periodo"=>$datosDebeAsiento[$i]["periodo"],                                            "ejercicio"=>$datosDebeAsiento[$i]["ejercicio"],                                            "orden"=>$datosDebeAsiento[$i]["orden"],                                            "concepto"=>$datosDebeAsiento[$i]["concepto"],                                            "cantidad"=>$datosDebeAsiento[$i]["cantidad"],                                            "DoH"=>"D"                                            );            }            for($i=1;$i<=count($datosHaberAsiento);$i++){                $datosAsientoOriginal[]=array(                                            "IdMovimiento"=>$datosHaberAsiento[$i]["IdMovimiento"],                                            "asiento"=>$datosDebeAsiento[$i]["asiento"],                                            "cuenta"=>$datosHaberAsiento[$i]["cuenta"],                                            "periodo"=>$datosHaberAsiento[$i]["periodo"],                                            "ejercicio"=>$datosHaberAsiento[$i]["ejercicio"],                                            "orden"=>$datosHaberAsiento[$i]["orden"],                                            "concepto"=>$datosHaberAsiento[$i]["concepto"],                                            "cantidad"=>$datosHaberAsiento[$i]["cantidad"],                                            "DoH"=>"H"                                            );            }            $OK2 = $clsCNContabilidad->EditarIngresosGastos($numAsientoNuevo,$datosAsientoOriginal, $_SESSION["idEmp"],                    $cuentasAsiento['OTRAS'],$fecha,$asiento['Periodo'], $ejercicio, $_SESSION["strUsuario"]);               //indico la fecha de la importacion en la tabla tbmovimientos            if($OK2<>FALSE){                $clsCNContabilidad->AsientoImportado_tbmovimientos($numAsientoNuevo);                $clsCNContabilidad->ActualizarAsientoImportado_tbmovimientos($numAsientoNuevo);            }            break;    }}//si todo a ido correcto hemos llegado hasta aqui por lo que devolvemos OKecho '... OK';echo '</td>';    echo '</tr>';    ?>